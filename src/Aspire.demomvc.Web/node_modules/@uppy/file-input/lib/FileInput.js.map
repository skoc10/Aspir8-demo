{"version":3,"names":["h","UIPlugin","toArray","packageJson","locale","defaultOptions","pretty","inputName","FileInput","constructor","uppy","opts","id","title","type","defaultLocale","i18nInit","render","bind","handleInputChange","handleClick","addFiles","files","descriptors","map","file","source","name","data","err","log","event","target","value","input","click","hiddenInputStyle","width","height","opacity","overflow","position","zIndex","restrictions","accept","allowedFileTypes","join","undefined","className","style","onChange","multiple","maxNumberOfFiles","ref","onClick","i18n","install","mount","uninstall","unmount","VERSION","version"],"sources":["FileInput.tsx"],"sourcesContent":["import { h, type ComponentChild } from 'preact'\n\nimport { UIPlugin, Uppy, type UIPluginOptions } from '@uppy/core'\nimport toArray from '@uppy/utils/lib/toArray'\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport type { DefinePluginOpts } from '@uppy/core/lib/BasePlugin.js'\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nimport packageJson from '../package.json'\nimport locale from './locale.ts'\n\nexport interface FileInputOptions extends UIPluginOptions {\n  pretty?: boolean\n  inputName?: string\n}\n// Default options, must be kept in sync with @uppy/react/src/FileInput.js.\nconst defaultOptions = {\n  pretty: true,\n  inputName: 'files[]',\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/files\ninterface HTMLFileInputElement extends HTMLInputElement {\n  files: FileList\n}\n\ntype Opts = DefinePluginOpts<FileInputOptions, keyof typeof defaultOptions>\n\nexport default class FileInput<M extends Meta, B extends Body> extends UIPlugin<\n  Opts,\n  M,\n  B\n> {\n  static VERSION = packageJson.version\n\n  input: HTMLFileInputElement | null\n\n  constructor(uppy: Uppy<M, B>, opts?: FileInputOptions) {\n    super(uppy, { ...defaultOptions, ...opts })\n    this.id = this.opts.id || 'FileInput'\n    this.title = 'File Input'\n    this.type = 'acquirer'\n\n    this.defaultLocale = locale\n\n    this.i18nInit()\n\n    this.render = this.render.bind(this)\n    this.handleInputChange = this.handleInputChange.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n  }\n\n  addFiles(files: File[]): void {\n    const descriptors = files.map((file) => ({\n      source: this.id,\n      name: file.name,\n      type: file.type,\n      data: file,\n    }))\n\n    try {\n      this.uppy.addFiles(descriptors)\n    } catch (err) {\n      this.uppy.log(err)\n    }\n  }\n\n  private handleInputChange(event: Event) {\n    this.uppy.log('[FileInput] Something selected through input...')\n    const files = toArray((event.target as HTMLFileInputElement).files)\n    this.addFiles(files)\n\n    // We clear the input after a file is selected, because otherwise\n    // change event is not fired in Chrome and Safari when a file\n    // with the same name is selected.\n    // ___Why not use value=\"\" on <input/> instead?\n    //    Because if we use that method of clearing the input,\n    //    Chrome will not trigger change if we drop the same file twice (Issue #768).\n    // @ts-expect-error yes\n    event.target.value = null // eslint-disable-line no-param-reassign\n  }\n\n  private handleClick() {\n    this.input!.click()\n  }\n\n  render(): ComponentChild {\n    /* http://tympanus.net/codrops/2015/09/15/styling-customizing-file-inputs-smart-way/ */\n    const hiddenInputStyle = {\n      width: '0.1px',\n      height: '0.1px',\n      opacity: 0,\n      overflow: 'hidden',\n      position: 'absolute',\n      zIndex: -1,\n    } satisfies h.JSX.IntrinsicElements['input']['style']\n\n    const { restrictions } = this.uppy.opts\n    const accept =\n      restrictions.allowedFileTypes ?\n        restrictions.allowedFileTypes.join(',')\n      : undefined\n\n    return (\n      <div className=\"uppy-FileInput-container\">\n        <input\n          className=\"uppy-FileInput-input\"\n          style={this.opts.pretty ? hiddenInputStyle : undefined}\n          type=\"file\"\n          name={this.opts.inputName}\n          onChange={this.handleInputChange}\n          multiple={restrictions.maxNumberOfFiles !== 1}\n          accept={accept}\n          ref={(input) => {\n            this.input = input as HTMLFileInputElement\n          }}\n        />\n        {this.opts.pretty && (\n          <button\n            className=\"uppy-FileInput-btn\"\n            type=\"button\"\n            onClick={this.handleClick}\n          >\n            {this.i18n('chooseFiles')}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  install(): void {\n    const { target } = this.opts\n    if (target) {\n      this.mount(target, this)\n    }\n  }\n\n  uninstall(): void {\n    this.unmount()\n  }\n}\n"],"mappings":"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"}