{"version":3,"names":["BasePlugin","tus","EventManager","NetworkError","isNetworkError","RateLimitedQueue","hasProperty","filterNonFailedFiles","filterFilesToEmitUploadStarted","getFingerprint","packageJson","tusDefaultOptions","endpoint","uploadUrl","metadata","uploadSize","onProgress","onChunkComplete","onSuccess","onError","overridePatchMethod","headers","addRequestId","chunkSize","Infinity","retryDelays","parallelUploads","removeFingerprintOnSuccess","uploadLengthDeferred","uploadDataDuringCreation","defaultOptions","limit","withCredentials","_retryDelayIterator","_classPrivateFieldLooseKey","_uploadLocalFile","_getCompanionClientArgs","_uploadFiles","_handleUpload","Tus","constructor","uppy","opts","_this$opts$rateLimite","_this$opts$retryDelay","Object","defineProperty","value","_uploadFiles2","_getCompanionClientArgs2","_uploadLocalFile2","writable","fileIDs","length","log","filesToUpload","getFilesByIds","_classPrivateFieldLooseBase","type","id","allowedMetaFields","undefined","Error","requests","rateLimitedQueue","values","uploaders","create","uploaderEvents","handleResetProgress","bind","files","getState","keys","forEach","fileID","_files$fileID","tusState","setState","resetUploaderReferences","uploader","abort","remove","onReceiveUploadUrl","file","uploadURL","currentFile","getFile","setFileState","install","capabilities","resumableUploads","addUploader","on","uninstall","removeUploader","_this","Promise","resolve","reject","queuedRequest","qRequest","upload","onShouldRetry","onBeforeRequest","commonOpts","uploadOptions","fingerprint","req","xhr","getUnderlyingObject","userProvidedPromise","shouldBeRequeued","done","p","res","run","isPaused","all","err","_queuedRequest","originalRequest","emit","bytesUploaded","bytesTotal","url","_upload$url","uploadResp","status","body","name","defaultOnShouldRetry","_err$originalResponse","originalResponse","getStatus","_classPrivateFieldLoo","next","rateLimit","navigator","onLine","pause","window","addEventListener","resume","once","fn","error","retryAttempt","copyProp","obj","srcProp","destProp","meta","Array","isArray","item","String","Upload","data","eventManager","start","findPreviousUploads","then","previousUploads","previousUpload","creationTime","resumeFromPreviousUpload","onFileRemove","targetFileID","onPause","onPauseAll","onCancelAll","_temp","reason","onResumeAll","catch","_file$remote","assign","remote","protocol","size","filesFiltered","filesToEmit","allSettled","map","isRemote","getQueue","controller","AbortController","removedHandler","removedFile","uploadPromise","getRequestClientForFile","uploadRemoteFile","signal","wrapSyncFunction","off","priority","VERSION","version"],"sources":["index.ts"],"sourcesContent":["import BasePlugin, {\n  type DefinePluginOpts,\n  type PluginOpts,\n} from '@uppy/core/lib/BasePlugin.js'\nimport * as tus from 'tus-js-client'\nimport EventManager from '@uppy/core/lib/EventManager.js'\nimport NetworkError from '@uppy/utils/lib/NetworkError'\nimport isNetworkError from '@uppy/utils/lib/isNetworkError'\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore untyped\nimport { RateLimitedQueue } from '@uppy/utils/lib/RateLimitedQueue'\nimport hasProperty from '@uppy/utils/lib/hasProperty'\nimport {\n  filterNonFailedFiles,\n  filterFilesToEmitUploadStarted,\n} from '@uppy/utils/lib/fileFilters'\nimport type { Meta, Body, UppyFile } from '@uppy/utils/lib/UppyFile'\nimport type { Uppy } from '@uppy/core'\nimport type { RequestClient } from '@uppy/companion-client'\nimport getFingerprint from './getFingerprint.ts'\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nimport packageJson from '../package.json'\n\ndeclare module '@uppy/utils/lib/UppyFile' {\n  // eslint-disable-next-line no-shadow, @typescript-eslint/no-unused-vars\n  export interface UppyFile<M extends Meta, B extends Body> {\n    // TODO: figure out what else is in this type\n    tus?: { uploadUrl?: string | null }\n  }\n}\n\ntype RestTusUploadOptions = Omit<\n  tus.UploadOptions,\n  'onShouldRetry' | 'onBeforeRequest' | 'headers'\n>\n\nexport type TusDetailedError = tus.DetailedError\n\nexport interface TusOpts<M extends Meta, B extends Body>\n  extends PluginOpts,\n    RestTusUploadOptions {\n  endpoint: string\n  headers?:\n    | Record<string, string>\n    | ((file: UppyFile<M, B>) => Record<string, string>)\n  limit?: number\n  chunkSize?: number\n  onBeforeRequest?: (req: tus.HttpRequest, file: UppyFile<M, B>) => void\n  onShouldRetry?: (\n    err: tus.DetailedError,\n    retryAttempt: number,\n    options: TusOpts<M, B>,\n    next: (e: tus.DetailedError) => void,\n  ) => boolean\n  retryDelays?: number[]\n  withCredentials?: boolean\n  allowedMetaFields?: string[]\n  rateLimitedQueue?: RateLimitedQueue\n}\n\n/**\n * Extracted from https://github.com/tus/tus-js-client/blob/master/lib/upload.js#L13\n * excepted we removed 'fingerprint' key to avoid adding more dependencies\n */\nconst tusDefaultOptions = {\n  endpoint: '',\n\n  uploadUrl: null,\n  metadata: {},\n  uploadSize: null,\n\n  onProgress: null,\n  onChunkComplete: null,\n  onSuccess: null,\n  onError: null,\n\n  overridePatchMethod: false,\n  headers: {},\n  addRequestId: false,\n\n  chunkSize: Infinity,\n  retryDelays: [100, 1000, 3000, 5000],\n  parallelUploads: 1,\n  removeFingerprintOnSuccess: false,\n  uploadLengthDeferred: false,\n  uploadDataDuringCreation: false,\n} satisfies tus.UploadOptions\n\nconst defaultOptions = {\n  limit: 20,\n  retryDelays: tusDefaultOptions.retryDelays,\n  withCredentials: false,\n} satisfies Partial<TusOpts<any, any>>\n\ntype Opts<M extends Meta, B extends Body> = DefinePluginOpts<\n  TusOpts<M, B>,\n  keyof typeof defaultOptions\n>\n\n/**\n * Tus resumable file uploader\n */\nexport default class Tus<M extends Meta, B extends Body> extends BasePlugin<\n  Opts<M, B>,\n  M,\n  B\n> {\n  static VERSION = packageJson.version\n\n  #retryDelayIterator\n\n  requests: RateLimitedQueue\n\n  uploaders: Record<string, tus.Upload | null>\n\n  uploaderEvents: Record<string, EventManager<M, B> | null>\n\n  constructor(uppy: Uppy<M, B>, opts: TusOpts<M, B>) {\n    super(uppy, { ...defaultOptions, ...opts })\n    this.type = 'uploader'\n    this.id = this.opts.id || 'Tus'\n\n    if (opts?.allowedMetaFields === undefined && 'metaFields' in this.opts) {\n      throw new Error(\n        'The `metaFields` option has been renamed to `allowedMetaFields`.',\n      )\n    }\n\n    if ('autoRetry' in opts) {\n      throw new Error(\n        'The `autoRetry` option was deprecated and has been removed.',\n      )\n    }\n\n    /**\n     * Simultaneous upload limiting is shared across all uploads with this plugin.\n     *\n     * @type {RateLimitedQueue}\n     */\n    this.requests =\n      this.opts.rateLimitedQueue ?? new RateLimitedQueue(this.opts.limit)\n    this.#retryDelayIterator = this.opts.retryDelays?.values()\n\n    this.uploaders = Object.create(null)\n    this.uploaderEvents = Object.create(null)\n\n    this.handleResetProgress = this.handleResetProgress.bind(this)\n  }\n\n  handleResetProgress(): void {\n    const files = { ...this.uppy.getState().files }\n    Object.keys(files).forEach((fileID) => {\n      // Only clone the file object if it has a Tus `uploadUrl` attached.\n      if (files[fileID]?.tus?.uploadUrl) {\n        const tusState = { ...files[fileID].tus }\n        delete tusState.uploadUrl\n        files[fileID] = { ...files[fileID], tus: tusState }\n      }\n    })\n\n    this.uppy.setState({ files })\n  }\n\n  /**\n   * Clean up all references for a file's upload: the tus.Upload instance,\n   * any events related to the file, and the Companion WebSocket connection.\n   */\n  resetUploaderReferences(fileID: string, opts?: { abort: boolean }): void {\n    const uploader = this.uploaders[fileID]\n    if (uploader) {\n      uploader.abort()\n\n      if (opts?.abort) {\n        uploader.abort(true)\n      }\n\n      this.uploaders[fileID] = null\n    }\n    if (this.uploaderEvents[fileID]) {\n      this.uploaderEvents[fileID]!.remove()\n      this.uploaderEvents[fileID] = null\n    }\n  }\n\n  /**\n   * Create a new Tus upload.\n   *\n   * A lot can happen during an upload, so this is quite hard to follow!\n   * - First, the upload is started. If the file was already paused by the time the upload starts, nothing should happen.\n   *   If the `limit` option is used, the upload must be queued onto the `this.requests` queue.\n   *   When an upload starts, we store the tus.Upload instance, and an EventManager instance that manages the event listeners\n   *   for pausing, cancellation, removal, etc.\n   * - While the upload is in progress, it may be paused or cancelled.\n   *   Pausing aborts the underlying tus.Upload, and removes the upload from the `this.requests` queue. All other state is\n   *   maintained.\n   *   Cancelling removes the upload from the `this.requests` queue, and completely aborts the upload-- the `tus.Upload`\n   *   instance is aborted and discarded, the EventManager instance is destroyed (removing all listeners).\n   *   Resuming the upload uses the `this.requests` queue as well, to prevent selectively pausing and resuming uploads from\n   *   bypassing the limit.\n   * - After completing an upload, the tus.Upload and EventManager instances are cleaned up, and the upload is marked as done\n   *   in the `this.requests` queue.\n   * - When an upload completed with an error, the same happens as on successful completion, but the `upload()` promise is\n   *   rejected.\n   *\n   * When working on this function, keep in mind:\n   *  - When an upload is completed or cancelled for any reason, the tus.Upload and EventManager instances need to be cleaned\n   *    up using this.resetUploaderReferences().\n   *  - When an upload is cancelled or paused, for any reason, it needs to be removed from the `this.requests` queue using\n   *    `queuedRequest.abort()`.\n   *  - When an upload is completed for any reason, including errors, it needs to be marked as such using\n   *    `queuedRequest.done()`.\n   *  - When an upload is started or resumed, it needs to go through the `this.requests` queue. The `queuedRequest` variable\n   *    must be updated so the other uses of it are valid.\n   *  - Before replacing the `queuedRequest` variable, the previous `queuedRequest` must be aborted, else it will keep taking\n   *    up a spot in the queue.\n   *\n   */\n  #uploadLocalFile(file: UppyFile<M, B>): Promise<tus.Upload | string> {\n    this.resetUploaderReferences(file.id)\n\n    // Create a new tus upload\n    return new Promise<tus.Upload | string>((resolve, reject) => {\n      let queuedRequest: ReturnType<RateLimitedQueue['run']>\n      let qRequest: () => () => void\n      let upload: tus.Upload\n\n      const opts = {\n        ...this.opts,\n        ...(file.tus || {}),\n      }\n\n      if (typeof opts.headers === 'function') {\n        opts.headers = opts.headers(file)\n      }\n\n      const { onShouldRetry, onBeforeRequest, ...commonOpts } = opts\n\n      const uploadOptions: tus.UploadOptions = {\n        ...tusDefaultOptions,\n        ...commonOpts,\n      }\n\n      // We override tus fingerprint to uppyâ€™s `file.id`, since the `file.id`\n      // now also includes `relativePath` for files added from folders.\n      // This means you can add 2 identical files, if one is in folder a,\n      // the other in folder b.\n      uploadOptions.fingerprint = getFingerprint(file)\n\n      uploadOptions.onBeforeRequest = async (req) => {\n        const xhr = req.getUnderlyingObject()\n        xhr.withCredentials = !!opts.withCredentials\n\n        let userProvidedPromise\n        if (typeof onBeforeRequest === 'function') {\n          userProvidedPromise = onBeforeRequest(req, file)\n        }\n\n        if (hasProperty(queuedRequest, 'shouldBeRequeued')) {\n          if (!queuedRequest.shouldBeRequeued) return Promise.reject()\n          // TODO: switch to `Promise.withResolvers` on the next major if available.\n          let done: () => void\n          // eslint-disable-next-line promise/param-names\n          const p = new Promise<void>((res) => {\n            done = res\n          })\n          queuedRequest = this.requests.run(() => {\n            if (file.isPaused) {\n              queuedRequest.abort()\n            }\n            done()\n            return () => {}\n          })\n          // If the request has been requeued because it was rate limited by the\n          // remote server, we want to wait for `RateLimitedQueue` to dispatch\n          // the re-try request.\n          // Therefore we create a promise that the queue will resolve when\n          // enough time has elapsed to expect not to be rate-limited again.\n          // This means we can hold the Tus retry here with a `Promise.all`,\n          // together with the returned value of the user provided\n          // `onBeforeRequest` option callback (in case it returns a promise).\n          await Promise.all([p, userProvidedPromise])\n          return undefined\n        }\n        return userProvidedPromise\n      }\n\n      uploadOptions.onError = (err) => {\n        this.uppy.log(err)\n\n        const xhr =\n          (err as tus.DetailedError).originalRequest != null ?\n            (err as tus.DetailedError).originalRequest.getUnderlyingObject()\n          : null\n        if (isNetworkError(xhr)) {\n          // eslint-disable-next-line no-param-reassign\n          err = new NetworkError(err, xhr)\n        }\n\n        this.resetUploaderReferences(file.id)\n        queuedRequest?.abort()\n\n        this.uppy.emit('upload-error', file, err)\n        if (typeof opts.onError === 'function') {\n          opts.onError(err)\n        }\n        reject(err)\n      }\n\n      uploadOptions.onProgress = (bytesUploaded, bytesTotal) => {\n        this.onReceiveUploadUrl(file, upload.url)\n        if (typeof opts.onProgress === 'function') {\n          opts.onProgress(bytesUploaded, bytesTotal)\n        }\n        this.uppy.emit('upload-progress', this.uppy.getFile(file.id), {\n          // TODO: remove `uploader` in next major\n          // @ts-expect-error untyped\n          uploader: this,\n          bytesUploaded,\n          bytesTotal,\n        })\n      }\n\n      uploadOptions.onSuccess = () => {\n        const uploadResp = {\n          uploadURL: upload.url ?? undefined,\n          status: 200,\n          body: {} as B,\n        }\n\n        this.resetUploaderReferences(file.id)\n        queuedRequest.done()\n\n        this.uppy.emit('upload-success', this.uppy.getFile(file.id), uploadResp)\n\n        if (upload.url) {\n          // @ts-expect-error not typed in tus-js-client\n          const { name } = upload.file\n          this.uppy.log(`Download ${name} from ${upload.url}`)\n        }\n        if (typeof opts.onSuccess === 'function') {\n          opts.onSuccess()\n        }\n\n        resolve(upload)\n      }\n\n      const defaultOnShouldRetry = (err: tus.DetailedError) => {\n        const status = err?.originalResponse?.getStatus()\n\n        if (status === 429) {\n          // HTTP 429 Too Many Requests => to avoid the whole download to fail, pause all requests.\n          if (!this.requests.isPaused) {\n            const next = this.#retryDelayIterator?.next()\n            if (next == null || next.done) {\n              return false\n            }\n            this.requests.rateLimit(next.value)\n          }\n        } else if (\n          status != null &&\n          status > 400 &&\n          status < 500 &&\n          status !== 409 &&\n          status !== 423\n        ) {\n          // HTTP 4xx, the server won't send anything, it's doesn't make sense to retry\n          // HTTP 409 Conflict (happens if the Upload-Offset header does not match the one on the server)\n          // HTTP 423 Locked (happens when a paused download is resumed too quickly)\n          return false\n        } else if (\n          typeof navigator !== 'undefined' &&\n          navigator.onLine === false\n        ) {\n          // The navigator is offline, let's wait for it to come back online.\n          if (!this.requests.isPaused) {\n            this.requests.pause()\n            window.addEventListener(\n              'online',\n              () => {\n                this.requests.resume()\n              },\n              { once: true },\n            )\n          }\n        }\n        queuedRequest.abort()\n        queuedRequest = {\n          shouldBeRequeued: true,\n          abort() {\n            this.shouldBeRequeued = false\n          },\n          done() {\n            throw new Error(\n              'Cannot mark a queued request as done: this indicates a bug',\n            )\n          },\n          fn() {\n            throw new Error('Cannot run a queued request: this indicates a bug')\n          },\n        }\n        return true\n      }\n\n      if (onShouldRetry != null) {\n        uploadOptions.onShouldRetry = (\n          error: tus.DetailedError,\n          retryAttempt: number,\n        ) => onShouldRetry(error, retryAttempt, opts, defaultOnShouldRetry)\n      } else {\n        uploadOptions.onShouldRetry = defaultOnShouldRetry\n      }\n\n      const copyProp = (\n        obj: Record<string, unknown>,\n        srcProp: string,\n        destProp: string,\n      ) => {\n        if (hasProperty(obj, srcProp) && !hasProperty(obj, destProp)) {\n          // eslint-disable-next-line no-param-reassign\n          obj[destProp] = obj[srcProp]\n        }\n      }\n\n      // We can't use `allowedMetaFields` to index generic M\n      // and we also don't care about the type specifically here,\n      // we just want to pass the meta fields along.\n      const meta: Record<string, string> = {}\n      const allowedMetaFields =\n        Array.isArray(opts.allowedMetaFields) ?\n          opts.allowedMetaFields\n          // Send along all fields by default.\n        : Object.keys(file.meta)\n      allowedMetaFields.forEach((item) => {\n        // tus type definition for metadata only accepts `Record<string, string>`\n        // but in reality (at runtime) it accepts `Record<string, unknown>`\n        // tus internally converts everything into a string, but let's do it here instead to be explicit.\n        // because Uppy can have anything inside meta values, (for example relativePath: null is often sent by uppy)\n        meta[item] = String(file.meta[item])\n      })\n\n      // tusd uses metadata fields 'filetype' and 'filename'\n      copyProp(meta, 'type', 'filetype')\n      copyProp(meta, 'name', 'filename')\n\n      uploadOptions.metadata = meta\n\n      upload = new tus.Upload(file.data, uploadOptions)\n      this.uploaders[file.id] = upload\n      const eventManager = new EventManager(this.uppy)\n      this.uploaderEvents[file.id] = eventManager\n\n      // eslint-disable-next-line prefer-const\n      qRequest = () => {\n        if (!file.isPaused) {\n          upload.start()\n        }\n        // Don't do anything here, the caller will take care of cancelling the upload itself\n        // using resetUploaderReferences(). This is because resetUploaderReferences() has to be\n        // called when this request is still in the queue, and has not been started yet, too. At\n        // that point this cancellation function is not going to be called.\n        // Also, we need to remove the request from the queue _without_ destroying everything\n        // related to this upload to handle pauses.\n        return () => {}\n      }\n\n      upload.findPreviousUploads().then((previousUploads) => {\n        const previousUpload = previousUploads[0]\n        if (previousUpload) {\n          this.uppy.log(\n            `[Tus] Resuming upload of ${file.id} started at ${previousUpload.creationTime}`,\n          )\n          upload.resumeFromPreviousUpload(previousUpload)\n        }\n      })\n\n      queuedRequest = this.requests.run(qRequest)\n\n      eventManager.onFileRemove(file.id, (targetFileID) => {\n        queuedRequest.abort()\n        this.resetUploaderReferences(file.id, { abort: !!upload.url })\n        resolve(`upload ${targetFileID} was removed`)\n      })\n\n      eventManager.onPause(file.id, (isPaused) => {\n        queuedRequest.abort()\n        if (isPaused) {\n          // Remove this file from the queue so another file can start in its place.\n          upload.abort()\n        } else {\n          // Resuming an upload should be queued, else you could pause and then\n          // resume a queued upload to make it skip the queue.\n          queuedRequest = this.requests.run(qRequest)\n        }\n      })\n\n      eventManager.onPauseAll(file.id, () => {\n        queuedRequest.abort()\n        upload.abort()\n      })\n\n      eventManager.onCancelAll(file.id, ({ reason } = {}) => {\n        if (reason === 'user') {\n          queuedRequest.abort()\n          this.resetUploaderReferences(file.id, { abort: !!upload.url })\n        }\n        resolve(`upload ${file.id} was canceled`)\n      })\n\n      eventManager.onResumeAll(file.id, () => {\n        queuedRequest.abort()\n        if (file.error) {\n          upload.abort()\n        }\n        queuedRequest = this.requests.run(qRequest)\n      })\n    }).catch((err) => {\n      this.uppy.emit('upload-error', file, err)\n      throw err\n    })\n  }\n\n  /**\n   * Store the uploadUrl on the file options, so that when Golden Retriever\n   * restores state, we will continue uploading to the correct URL.\n   */\n  onReceiveUploadUrl(file: UppyFile<M, B>, uploadURL: string | null): void {\n    const currentFile = this.uppy.getFile(file.id)\n    if (!currentFile) return\n    // Only do the update if we didn't have an upload URL yet.\n    if (!currentFile.tus || currentFile.tus.uploadUrl !== uploadURL) {\n      this.uppy.log('[Tus] Storing upload url')\n      this.uppy.setFileState(currentFile.id, {\n        tus: { ...currentFile.tus, uploadUrl: uploadURL },\n      })\n    }\n  }\n\n  #getCompanionClientArgs(file: UppyFile<M, B>) {\n    const opts = { ...this.opts }\n\n    if (file.tus) {\n      // Install file-specific upload overrides.\n      Object.assign(opts, file.tus)\n    }\n\n    if (typeof opts.headers === 'function') {\n      opts.headers = opts.headers(file)\n    }\n\n    return {\n      ...file.remote?.body,\n      endpoint: opts.endpoint,\n      uploadUrl: opts.uploadUrl,\n      protocol: 'tus',\n      size: file.data.size,\n      headers: opts.headers,\n      metadata: file.meta,\n    }\n  }\n\n  async #uploadFiles(files: UppyFile<M, B>[]) {\n    const filesFiltered = filterNonFailedFiles(files)\n    const filesToEmit = filterFilesToEmitUploadStarted(filesFiltered)\n    this.uppy.emit('upload-start', filesToEmit)\n\n    await Promise.allSettled(\n      filesFiltered.map((file) => {\n        if (file.isRemote) {\n          const getQueue = () => this.requests\n          const controller = new AbortController()\n\n          const removedHandler = (removedFile: UppyFile<M, B>) => {\n            if (removedFile.id === file.id) controller.abort()\n          }\n          this.uppy.on('file-removed', removedHandler)\n\n          const uploadPromise = this.uppy\n            .getRequestClientForFile<RequestClient<M, B>>(file)\n            .uploadRemoteFile(file, this.#getCompanionClientArgs(file), {\n              signal: controller.signal,\n              getQueue,\n            })\n\n          this.requests.wrapSyncFunction(\n            () => {\n              this.uppy.off('file-removed', removedHandler)\n            },\n            { priority: -1 },\n          )()\n\n          return uploadPromise\n        }\n\n        return this.#uploadLocalFile(file)\n      }),\n    )\n  }\n\n  #handleUpload = async (fileIDs: string[]) => {\n    if (fileIDs.length === 0) {\n      this.uppy.log('[Tus] No files to upload')\n      return\n    }\n\n    if (this.opts.limit === 0) {\n      this.uppy.log(\n        '[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0',\n        'warning',\n      )\n    }\n\n    this.uppy.log('[Tus] Uploading...')\n    const filesToUpload = this.uppy.getFilesByIds(fileIDs)\n\n    await this.#uploadFiles(filesToUpload)\n  }\n\n  install(): void {\n    this.uppy.setState({\n      capabilities: {\n        ...this.uppy.getState().capabilities,\n        resumableUploads: true,\n      },\n    })\n    this.uppy.addUploader(this.#handleUpload)\n\n    this.uppy.on('reset-progress', this.handleResetProgress)\n  }\n\n  uninstall(): void {\n    this.uppy.setState({\n      capabilities: {\n        ...this.uppy.getState().capabilities,\n        resumableUploads: false,\n      },\n    })\n    this.uppy.removeUploader(this.#handleUpload)\n  }\n}\n"],"mappings":"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"}