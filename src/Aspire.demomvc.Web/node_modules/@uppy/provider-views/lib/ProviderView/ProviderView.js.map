{"version":3,"names":["h","PQueue","getSafeFileId","AuthView","Header","Browser","CloseWrapper","View","packageJson","formatBreadcrumbs","breadcrumbs","slice","map","directory","name","join","prependPath","path","component","defaultPickerIcon","focusable","width","height","viewBox","d","defaultOptions","viewType","showTitles","showFilter","showBreadcrumbs","loadAllFiles","_abortController","_classPrivateFieldLooseKey","_withAbort","_list","_listFilesAndFolders","_recursivelyListAllFiles","ProviderView","constructor","plugin","opts","Object","defineProperty","value","_recursivelyListAllFiles2","_listFilesAndFolders2","_list2","_withAbort2","writable","filterQuery","bind","clearFilter","getFolder","getNextFolder","logout","handleAuth","handleScroll","donePicking","render","setPluginState","authenticated","undefined","files","folders","filterInput","isSearchVisible","currentSelection","registerRequestClient","tearDown","requestPath","setLoading","_classPrivateFieldLooseBase","signal","lastCheckbox","getPluginState","index","findIndex","dir","nextPagePath","newFiles","newFolders","concat","uppy","i18n","numFiles","length","err","info","message","handleError","folder","res","provider","ok","revoked","title","url","manual_revoke_url","newState","input","authFormData","login","preFirstRender","log","event","shouldHandleScroll","isHandlingScroll","combinedFiles","combinedFolders","error","messages","selectedItem","withRelDirPath","newItem","relDirPath","absDirPath","replace","isFolder","isEmpty","numNewFiles","queue","concurrency","onFiles","newFile","tagFile","getTagFile","id","getID","checkIfFileAlreadyExists","push","onIdle","smart_count","addFiles","file","requestClientId","forEach","clearSelection","state","viewOptions","_this","didFirstRender","targetViewOptions","loading","isChecked","recordShiftKeyPress","filterItems","hasInput","pluginIcon","icon","headerProps","username","browserProps","toggleCheckbox","showSearchFilter","search","clearSearch","searchTerm","searchOnInput","searchInputLabel","clearSearchLabel","noResultsLabel","done","cancel","cancelPicking","headerComponent","uppyFiles","getFiles","validateRestrictions","arguments","isLoading","onUnmount","pluginName","i18nArray","renderForm","renderAuthForm","op","_classPrivateFieldLoo","abort","abortController","AbortController","cancelRequest","on","off","_ref","items","list","item","_ref2","_ref3","curPath","filter","promises","add","Promise","all","VERSION","version"],"sources":["ProviderView.tsx"],"sourcesContent":["import { h } from 'preact'\nimport PQueue from 'p-queue'\n\nimport { getSafeFileId } from '@uppy/utils/lib/generateFileID'\n\nimport type {\n  UnknownProviderPlugin,\n  UnknownProviderPluginState,\n  Uppy,\n} from '@uppy/core/lib/Uppy.ts'\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport type { CompanionFile } from '@uppy/utils/lib/CompanionFile'\nimport type Translator from '@uppy/utils/lib/Translator'\nimport type { DefinePluginOpts } from '@uppy/core/lib/BasePlugin'\nimport AuthView from './AuthView.tsx'\nimport Header from './Header.tsx'\nimport Browser from '../Browser.tsx'\nimport CloseWrapper from '../CloseWrapper.ts'\nimport View, { type ViewOptions } from '../View.ts'\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nimport packageJson from '../../package.json'\n\nfunction formatBreadcrumbs(\n  breadcrumbs: UnknownProviderPluginState['breadcrumbs'],\n): string {\n  return breadcrumbs\n    .slice(1)\n    .map((directory) => directory.name)\n    .join('/')\n}\n\nfunction prependPath(path: string | undefined, component: string): string {\n  if (!path) return component\n  return `${path}/${component}`\n}\n\nexport function defaultPickerIcon() {\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      width=\"30\"\n      height=\"30\"\n      viewBox=\"0 0 30 30\"\n    >\n      <path d=\"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z\" />\n    </svg>\n  )\n}\n\ntype PluginType = 'Provider'\n\nconst defaultOptions = {\n  viewType: 'list',\n  showTitles: true,\n  showFilter: true,\n  showBreadcrumbs: true,\n  loadAllFiles: false,\n}\n\nexport interface ProviderViewOptions<M extends Meta, B extends Body>\n  extends ViewOptions<M, B, PluginType> {\n  renderAuthForm?: (args: {\n    pluginName: string\n    i18n: Translator['translateArray']\n    loading: boolean | string\n    onAuth: (authFormData: unknown) => Promise<void>\n  }) => h.JSX.Element\n}\n\ntype Opts<M extends Meta, B extends Body> = DefinePluginOpts<\n  ProviderViewOptions<M, B>,\n  keyof typeof defaultOptions\n>\n\n/**\n * Class to easily generate generic views for Provider plugins\n */\nexport default class ProviderView<M extends Meta, B extends Body> extends View<\n  M,\n  B,\n  PluginType,\n  Opts<M, B>\n> {\n  static VERSION = packageJson.version\n\n  username: string | undefined\n\n  nextPagePath: string | undefined\n\n  constructor(\n    plugin: UnknownProviderPlugin<M, B>,\n    opts: ProviderViewOptions<M, B>,\n  ) {\n    super(plugin, { ...defaultOptions, ...opts })\n\n    // Logic\n    this.filterQuery = this.filterQuery.bind(this)\n    this.clearFilter = this.clearFilter.bind(this)\n    this.getFolder = this.getFolder.bind(this)\n    this.getNextFolder = this.getNextFolder.bind(this)\n    this.logout = this.logout.bind(this)\n    this.handleAuth = this.handleAuth.bind(this)\n    this.handleScroll = this.handleScroll.bind(this)\n    this.donePicking = this.donePicking.bind(this)\n\n    // Visual\n    this.render = this.render.bind(this)\n\n    // Set default state for the plugin\n    this.plugin.setPluginState({\n      authenticated: undefined, // we don't know yet\n      files: [],\n      folders: [],\n      breadcrumbs: [],\n      filterInput: '',\n      isSearchVisible: false,\n      currentSelection: [],\n    })\n\n    this.registerRequestClient()\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  tearDown(): void {\n    // Nothing.\n  }\n\n  #abortController: AbortController | undefined\n\n  async #withAbort(op: (signal: AbortSignal) => Promise<void>) {\n    // prevent multiple requests in parallel from causing race conditions\n    this.#abortController?.abort()\n    const abortController = new AbortController()\n    this.#abortController = abortController\n    const cancelRequest = () => {\n      abortController.abort()\n      this.clearSelection()\n    }\n    try {\n      // @ts-expect-error this should be typed in @uppy/dashboard.\n      // Even then I don't think we can make this work without adding dashboard\n      // as a dependency to provider-views.\n      this.plugin.uppy.on('dashboard:close-panel', cancelRequest)\n      this.plugin.uppy.on('cancel-all', cancelRequest)\n\n      await op(abortController.signal)\n    } finally {\n      // @ts-expect-error this should be typed in @uppy/dashboard.\n      // Even then I don't think we can make this work without adding dashboard\n      // as a dependency to provider-views.\n      this.plugin.uppy.off('dashboard:close-panel', cancelRequest)\n      this.plugin.uppy.off('cancel-all', cancelRequest)\n      this.#abortController = undefined\n    }\n  }\n\n  async #list({\n    requestPath,\n    absDirPath,\n    signal,\n  }: {\n    requestPath?: string\n    absDirPath: string\n    signal: AbortSignal\n  }) {\n    const { username, nextPagePath, items } = await this.provider.list<{\n      username: string\n      nextPagePath: string\n      items: CompanionFile[]\n    }>(requestPath, { signal })\n    this.username = username || this.username\n\n    return {\n      items: items.map((item) => ({\n        ...item,\n        absDirPath,\n      })),\n      nextPagePath,\n    }\n  }\n\n  async #listFilesAndFolders({\n    breadcrumbs,\n    signal,\n  }: {\n    breadcrumbs: UnknownProviderPluginState['breadcrumbs']\n    signal: AbortSignal\n  }) {\n    const absDirPath = formatBreadcrumbs(breadcrumbs)\n\n    const { items, nextPagePath } = await this.#list({\n      requestPath: this.nextPagePath,\n      absDirPath,\n      signal,\n    })\n\n    this.nextPagePath = nextPagePath\n\n    const files: CompanionFile[] = []\n    const folders: CompanionFile[] = []\n\n    items.forEach((item) => {\n      if (item.isFolder) {\n        folders.push(item)\n      } else {\n        files.push(item)\n      }\n    })\n\n    return { files, folders }\n  }\n\n  /**\n   * Select a folder based on its id: fetches the folder and then updates state with its contents\n   * TODO rename to something better like selectFolder or navigateToFolder (breaking change?)\n   *\n   */\n  async getFolder(requestPath?: string, name?: string): Promise<void> {\n    this.setLoading(true)\n    try {\n      await this.#withAbort(async (signal) => {\n        this.lastCheckbox = undefined\n\n        let { breadcrumbs } = this.plugin.getPluginState()\n\n        const index = breadcrumbs.findIndex(\n          (dir) => requestPath === dir.requestPath,\n        )\n\n        if (index !== -1) {\n          // means we navigated back to a known directory (already in the stack), so cut the stack off there\n          breadcrumbs = breadcrumbs.slice(0, index + 1)\n        } else {\n          // we have navigated into a new (unknown) folder, add it to the stack\n          breadcrumbs = [...breadcrumbs, { requestPath, name }]\n        }\n\n        this.nextPagePath = requestPath\n        let files: CompanionFile[] = []\n        let folders: CompanionFile[] = []\n        do {\n          const { files: newFiles, folders: newFolders } =\n            await this.#listFilesAndFolders({\n              breadcrumbs,\n              signal,\n            })\n\n          files = files.concat(newFiles)\n          folders = folders.concat(newFolders)\n\n          this.setLoading(\n            this.plugin.uppy.i18n('loadedXFiles', {\n              numFiles: files.length + folders.length,\n            }),\n          )\n        } while (this.opts.loadAllFiles && this.nextPagePath)\n\n        this.plugin.setPluginState({\n          folders,\n          files,\n          breadcrumbs,\n          filterInput: '',\n        })\n      })\n    } catch (err) {\n      // This is the first call that happens when the provider view loads, after auth, so it's probably nice to show any\n      // error occurring here to the user.\n      if (err?.name === 'UserFacingApiError') {\n        this.plugin.uppy.info(\n          { message: this.plugin.uppy.i18n(err.message) },\n          'warning',\n          5000,\n        )\n        return\n      }\n\n      this.handleError(err)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  /**\n   * Fetches new folder\n   */\n  getNextFolder(folder: CompanionFile): void {\n    this.getFolder(folder.requestPath, folder.name)\n    this.lastCheckbox = undefined\n  }\n\n  /**\n   * Removes session token on client side.\n   */\n  async logout(): Promise<void> {\n    try {\n      await this.#withAbort(async (signal) => {\n        const res = await this.provider.logout<{\n          ok: boolean\n          revoked: boolean\n          manual_revoke_url: string\n        }>({\n          signal,\n        })\n        // res.ok is from the JSON body, not to be confused with Response.ok\n        if (res.ok) {\n          if (!res.revoked) {\n            const message = this.plugin.uppy.i18n('companionUnauthorizeHint', {\n              provider: this.plugin.title,\n              url: res.manual_revoke_url,\n            })\n            this.plugin.uppy.info(message, 'info', 7000)\n          }\n\n          const newState = {\n            authenticated: false,\n            files: [],\n            folders: [],\n            breadcrumbs: [],\n            filterInput: '',\n          }\n          this.plugin.setPluginState(newState)\n        }\n      })\n    } catch (err) {\n      this.handleError(err)\n    }\n  }\n\n  filterQuery(input: string): void {\n    this.plugin.setPluginState({ filterInput: input })\n  }\n\n  clearFilter(): void {\n    this.plugin.setPluginState({ filterInput: '' })\n  }\n\n  async handleAuth(authFormData?: unknown): Promise<void> {\n    try {\n      await this.#withAbort(async (signal) => {\n        this.setLoading(true)\n        await this.provider.login({ authFormData, signal })\n        this.plugin.setPluginState({ authenticated: true })\n        this.preFirstRender()\n      })\n    } catch (err) {\n      if (err.name === 'UserFacingApiError') {\n        this.plugin.uppy.info(\n          { message: this.plugin.uppy.i18n(err.message) },\n          'warning',\n          5000,\n        )\n        return\n      }\n\n      this.plugin.uppy.log(`login failed: ${err.message}`)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  async handleScroll(event: Event): Promise<void> {\n    if (this.shouldHandleScroll(event) && this.nextPagePath) {\n      this.isHandlingScroll = true\n\n      try {\n        await this.#withAbort(async (signal) => {\n          const { files, folders, breadcrumbs } = this.plugin.getPluginState()\n\n          const { files: newFiles, folders: newFolders } =\n            await this.#listFilesAndFolders({\n              breadcrumbs,\n              signal,\n            })\n\n          const combinedFiles = files.concat(newFiles)\n          const combinedFolders = folders.concat(newFolders)\n\n          this.plugin.setPluginState({\n            folders: combinedFolders,\n            files: combinedFiles,\n          })\n        })\n      } catch (error) {\n        this.handleError(error)\n      } finally {\n        this.isHandlingScroll = false\n      }\n    }\n  }\n\n  async #recursivelyListAllFiles({\n    requestPath,\n    absDirPath,\n    relDirPath,\n    queue,\n    onFiles,\n    signal,\n  }: {\n    requestPath: string\n    absDirPath: string\n    relDirPath: string\n    queue: PQueue\n    onFiles: (files: CompanionFile[]) => void\n    signal: AbortSignal\n  }) {\n    let curPath = requestPath\n\n    while (curPath) {\n      const res = await this.#list({ requestPath: curPath, absDirPath, signal })\n      curPath = res.nextPagePath\n\n      const files = res.items.filter((item) => !item.isFolder)\n      const folders = res.items.filter((item) => item.isFolder)\n\n      onFiles(files)\n\n      // recursively queue call to self for each folder\n      const promises = folders.map(async (folder) =>\n        queue.add(async () =>\n          this.#recursivelyListAllFiles({\n            requestPath: folder.requestPath,\n            absDirPath: prependPath(absDirPath, folder.name),\n            relDirPath: prependPath(relDirPath, folder.name),\n            queue,\n            onFiles,\n            signal,\n          }),\n        ),\n      )\n      await Promise.all(promises) // in case we get an error\n    }\n  }\n\n  async donePicking(): Promise<void> {\n    this.setLoading(true)\n    try {\n      await this.#withAbort(async (signal) => {\n        const { currentSelection } = this.plugin.getPluginState()\n\n        const messages: string[] = []\n        const newFiles: CompanionFile[] = []\n\n        for (const selectedItem of currentSelection) {\n          const { requestPath } = selectedItem\n\n          const withRelDirPath = (newItem: CompanionFile) => ({\n            ...newItem,\n            // calculate the file's path relative to the user's selected item's path\n            // see https://github.com/transloadit/uppy/pull/4537#issuecomment-1614236655\n            relDirPath: (newItem.absDirPath as string)\n              .replace(selectedItem.absDirPath as string, '')\n              .replace(/^\\//, ''),\n          })\n\n          if (selectedItem.isFolder) {\n            let isEmpty = true\n            let numNewFiles = 0\n\n            const queue = new PQueue({ concurrency: 6 })\n\n            const onFiles = (files: CompanionFile[]) => {\n              for (const newFile of files) {\n                const tagFile = this.getTagFile(newFile)\n\n                const id = getSafeFileId(tagFile, this.plugin.uppy.getID())\n                // If the same folder is added again, we don't want to send\n                // X amount of duplicate file notifications, we want to say\n                // the folder was already added. This checks if all files are duplicate,\n                // if that's the case, we don't add the files.\n                if (!this.plugin.uppy.checkIfFileAlreadyExists(id)) {\n                  newFiles.push(withRelDirPath(newFile))\n                  numNewFiles++\n                  this.setLoading(\n                    this.plugin.uppy.i18n('addedNumFiles', {\n                      numFiles: numNewFiles,\n                    }),\n                  )\n                }\n                isEmpty = false\n              }\n            }\n\n            await this.#recursivelyListAllFiles({\n              requestPath,\n              absDirPath: prependPath(\n                selectedItem.absDirPath,\n                selectedItem.name,\n              ),\n              relDirPath: selectedItem.name,\n              queue,\n              onFiles,\n              signal,\n            })\n            await queue.onIdle()\n\n            let message\n            if (isEmpty) {\n              message = this.plugin.uppy.i18n('emptyFolderAdded')\n            } else if (numNewFiles === 0) {\n              message = this.plugin.uppy.i18n('folderAlreadyAdded', {\n                folder: selectedItem.name,\n              })\n            } else {\n              // TODO we don't really know at this point whether any files were actually added\n              // (only later after addFiles has been called) so we should probably rewrite this.\n              // Example: If all files fail to add due to restriction error, it will still say \"Added 100 files from folder\"\n              message = this.plugin.uppy.i18n('folderAdded', {\n                smart_count: numNewFiles,\n                folder: selectedItem.name,\n              })\n            }\n\n            messages.push(message)\n          } else {\n            newFiles.push(withRelDirPath(selectedItem))\n          }\n        }\n\n        // Note: this.plugin.uppy.addFiles must be only run once we are done fetching all files,\n        // because it will cause the loading screen to disappear,\n        // and that will allow the user to start the upload, so we need to make sure we have\n        // finished all async operations before we add any file\n        // see https://github.com/transloadit/uppy/pull/4384\n        this.plugin.uppy.log('Adding files from a remote provider')\n        this.plugin.uppy.addFiles(\n          // @ts-expect-error `addFiles` expects `body` to be `File` or `Blob`,\n          // but as the todo comment in `View.ts` indicates, we strangly pass `CompanionFile` as `body`.\n          // For now it's better to ignore than to have a potential breaking change.\n          newFiles.map((file) => this.getTagFile(file, this.requestClientId)),\n        )\n\n        this.plugin.setPluginState({ filterInput: '' })\n        messages.forEach((message) => this.plugin.uppy.info(message))\n\n        this.clearSelection()\n      })\n    } catch (err) {\n      this.handleError(err)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  render(\n    state: unknown,\n    viewOptions: Omit<ViewOptions<M, B, PluginType>, 'provider'> = {},\n  ) {\n    const { authenticated, didFirstRender } = this.plugin.getPluginState()\n    const { i18n } = this.plugin.uppy\n\n    if (!didFirstRender) {\n      this.preFirstRender()\n    }\n\n    const targetViewOptions = { ...this.opts, ...viewOptions }\n    const { files, folders, filterInput, loading, currentSelection } =\n      this.plugin.getPluginState()\n    const { isChecked, recordShiftKeyPress, filterItems } = this\n    const hasInput = filterInput !== ''\n    const pluginIcon = this.plugin.icon || defaultPickerIcon\n\n    const headerProps = {\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      getFolder: this.getFolder,\n      breadcrumbs: this.plugin.getPluginState().breadcrumbs,\n      pluginIcon,\n      title: this.plugin.title,\n      logout: this.logout,\n      username: this.username,\n      i18n,\n    }\n\n    const browserProps = {\n      isChecked,\n      toggleCheckbox: this.toggleCheckbox.bind(this),\n      recordShiftKeyPress,\n      currentSelection,\n      files: hasInput ? filterItems(files) : files,\n      folders: hasInput ? filterItems(folders) : folders,\n      getNextFolder: this.getNextFolder,\n      getFolder: this.getFolder,\n      loadAllFiles: this.opts.loadAllFiles,\n\n      // For SearchFilterInput component\n      showSearchFilter: targetViewOptions.showFilter,\n      search: this.filterQuery,\n      clearSearch: this.clearFilter,\n      searchTerm: filterInput,\n      searchOnInput: true,\n      searchInputLabel: i18n('filter'),\n      clearSearchLabel: i18n('resetFilter'),\n\n      noResultsLabel: i18n('noFilesFound'),\n      logout: this.logout,\n      handleScroll: this.handleScroll,\n      done: this.donePicking,\n      cancel: this.cancelPicking,\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      headerComponent: <Header<M, B> {...headerProps} />,\n      title: this.plugin.title,\n      viewType: targetViewOptions.viewType,\n      showTitles: targetViewOptions.showTitles,\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      pluginIcon,\n      i18n: this.plugin.uppy.i18n,\n      uppyFiles: this.plugin.uppy.getFiles(),\n      validateRestrictions: (\n        ...args: Parameters<Uppy<M, B>['validateRestrictions']>\n      ) => this.plugin.uppy.validateRestrictions(...args),\n      isLoading: loading,\n    }\n\n    if (authenticated === false) {\n      return (\n        <CloseWrapper onUnmount={this.clearSelection}>\n          <AuthView\n            pluginName={this.plugin.title}\n            pluginIcon={pluginIcon}\n            handleAuth={this.handleAuth}\n            i18n={this.plugin.uppy.i18nArray}\n            renderForm={this.opts.renderAuthForm}\n            loading={loading}\n          />\n        </CloseWrapper>\n      )\n    }\n\n    return (\n      <CloseWrapper onUnmount={this.clearSelection}>\n        {/* eslint-disable-next-line react/jsx-props-no-spreading */}\n        <Browser<M, B> {...browserProps} />\n      </CloseWrapper>\n    )\n  }\n}\n"],"mappings":";;;AAAA,SAASA,CAAC,QAAQ,QAAQ;AAC1B,OAAOC,MAAM,MAAM,SAAS;AAE5B,SAASC,aAAa,QAAQ,gCAAgC;AAW9D,OAAOC,QAAQ,MAAM,eAAgB;AACrC,OAAOC,MAAM,MAAM,aAAc;AACjC,OAAOC,OAAO,MAAM,eAAgB;AACpC,OAAOC,YAAY,MAAM,oBAAoB;AAC7C,OAAOC,IAAI,MAA4B,YAAY;;AAEnD;AACA;AAAA,MACOC,WAAW;EAAA;AAAA;AAElB,SAASC,iBAAiBA,CACxBC,WAAsD,EAC9C;EACR,OAAOA,WAAW,CACfC,KAAK,CAAC,CAAC,CAAC,CACRC,GAAG,CAAEC,SAAS,IAAKA,SAAS,CAACC,IAAI,CAAC,CAClCC,IAAI,CAAC,GAAG,CAAC;AACd;AAEA,SAASC,WAAWA,CAACC,IAAwB,EAAEC,SAAiB,EAAU;EACxE,IAAI,CAACD,IAAI,EAAE,OAAOC,SAAS;EAC3B,OAAQ,GAAED,IAAK,IAAGC,SAAU,EAAC;AAC/B;AAEA,OAAO,SAASC,iBAAiBA,CAAA,EAAG;EAClC,OACEnB,CAAA;IACE,eAAY,MAAM;IAClBoB,SAAS,EAAC,OAAO;IACjBC,KAAK,EAAC,IAAI;IACVC,MAAM,EAAC,IAAI;IACXC,OAAO,EAAC;EAAW,GAEnBvB,CAAA;IAAMwB,CAAC,EAAC;EAAyK,CAAE,CAChL,CAAC;AAEV;AAIA,MAAMC,cAAc,GAAG;EACrBC,QAAQ,EAAE,MAAM;EAChBC,UAAU,EAAE,IAAI;EAChBC,UAAU,EAAE,IAAI;EAChBC,eAAe,EAAE,IAAI;EACrBC,YAAY,EAAE;AAChB,CAAC;AAAA,IAAAC,gBAAA,gBAAAC,0BAAA;AAAA,IAAAC,UAAA,gBAAAD,0BAAA;AAAA,IAAAE,KAAA,gBAAAF,0BAAA;AAAA,IAAAG,oBAAA,gBAAAH,0BAAA;AAAA,IAAAI,wBAAA,gBAAAJ,0BAAA;AAiBD;AACA;AACA;AACA,eAAe,MAAMK,YAAY,SAAyC9B,IAAI,CAK5E;EAOA+B,WAAWA,CACTC,MAAmC,EACnCC,IAA+B,EAC/B;IACA,KAAK,CAACD,MAAM,EAAE;MAAE,GAAGd,cAAc;MAAE,GAAGe;IAAK,CAAC,CAAC;;IAE7C;IAAAC,MAAA,CAAAC,cAAA,OAAAN,wBAAA;MAAAO,KAAA,EAAAC;IAAA;IAAAH,MAAA,CAAAC,cAAA,OAAAP,oBAAA;MAAAQ,KAAA,EAAAE;IAAA;IAAAJ,MAAA,CAAAC,cAAA,OAAAR,KAAA;MAAAS,KAAA,EAAAG;IAAA;IAAAL,MAAA,CAAAC,cAAA,OAAAT,UAAA;MAAAU,KAAA,EAAAI;IAAA;IAAAN,MAAA,CAAAC,cAAA,OAAAX,gBAAA;MAAAiB,QAAA;MAAAL,KAAA;IAAA;IACA,IAAI,CAACM,WAAW,GAAG,IAAI,CAACA,WAAW,CAACC,IAAI,CAAC,IAAI,CAAC;IAC9C,IAAI,CAACC,WAAW,GAAG,IAAI,CAACA,WAAW,CAACD,IAAI,CAAC,IAAI,CAAC;IAC9C,IAAI,CAACE,SAAS,GAAG,IAAI,CAACA,SAAS,CAACF,IAAI,CAAC,IAAI,CAAC;IAC1C,IAAI,CAACG,aAAa,GAAG,IAAI,CAACA,aAAa,CAACH,IAAI,CAAC,IAAI,CAAC;IAClD,IAAI,CAACI,MAAM,GAAG,IAAI,CAACA,MAAM,CAACJ,IAAI,CAAC,IAAI,CAAC;IACpC,IAAI,CAACK,UAAU,GAAG,IAAI,CAACA,UAAU,CAACL,IAAI,CAAC,IAAI,CAAC;IAC5C,IAAI,CAACM,YAAY,GAAG,IAAI,CAACA,YAAY,CAACN,IAAI,CAAC,IAAI,CAAC;IAChD,IAAI,CAACO,WAAW,GAAG,IAAI,CAACA,WAAW,CAACP,IAAI,CAAC,IAAI,CAAC;;IAE9C;IACA,IAAI,CAACQ,MAAM,GAAG,IAAI,CAACA,MAAM,CAACR,IAAI,CAAC,IAAI,CAAC;;IAEpC;IACA,IAAI,CAACX,MAAM,CAACoB,cAAc,CAAC;MACzBC,aAAa,EAAEC,SAAS;MAAE;MAC1BC,KAAK,EAAE,EAAE;MACTC,OAAO,EAAE,EAAE;MACXrD,WAAW,EAAE,EAAE;MACfsD,WAAW,EAAE,EAAE;MACfC,eAAe,EAAE,KAAK;MACtBC,gBAAgB,EAAE;IACpB,CAAC,CAAC;IAEF,IAAI,CAACC,qBAAqB,CAAC,CAAC;EAC9B;;EAEA;EACAC,QAAQA,CAAA,EAAS;IACf;EAAA;EAwFF;AACF;AACA;AACA;AACA;EACE,MAAMhB,SAASA,CAACiB,WAAoB,EAAEvD,IAAa,EAAiB;IAClE,IAAI,CAACwD,UAAU,CAAC,IAAI,CAAC;IACrB,IAAI;MACF,MAAAC,2BAAA,CAAM,IAAI,EAAAtC,UAAA,EAAAA,UAAA,EAAY,MAAOuC,MAAM,IAAK;QACtC,IAAI,CAACC,YAAY,GAAGZ,SAAS;QAE7B,IAAI;UAAEnD;QAAY,CAAC,GAAG,IAAI,CAAC6B,MAAM,CAACmC,cAAc,CAAC,CAAC;QAElD,MAAMC,KAAK,GAAGjE,WAAW,CAACkE,SAAS,CAChCC,GAAG,IAAKR,WAAW,KAAKQ,GAAG,CAACR,WAC/B,CAAC;QAED,IAAIM,KAAK,KAAK,CAAC,CAAC,EAAE;UAChB;UACAjE,WAAW,GAAGA,WAAW,CAACC,KAAK,CAAC,CAAC,EAAEgE,KAAK,GAAG,CAAC,CAAC;QAC/C,CAAC,MAAM;UACL;UACAjE,WAAW,GAAG,CAAC,GAAGA,WAAW,EAAE;YAAE2D,WAAW;YAAEvD;UAAK,CAAC,CAAC;QACvD;QAEA,IAAI,CAACgE,YAAY,GAAGT,WAAW;QAC/B,IAAIP,KAAsB,GAAG,EAAE;QAC/B,IAAIC,OAAwB,GAAG,EAAE;QACjC,GAAG;UACD,MAAM;YAAED,KAAK,EAAEiB,QAAQ;YAAEhB,OAAO,EAAEiB;UAAW,CAAC,GAC5C,MAAAT,2BAAA,CAAM,IAAI,EAAApC,oBAAA,EAAAA,oBAAA,EAAsB;YAC9BzB,WAAW;YACX8D;UACF,CAAC,CAAC;UAEJV,KAAK,GAAGA,KAAK,CAACmB,MAAM,CAACF,QAAQ,CAAC;UAC9BhB,OAAO,GAAGA,OAAO,CAACkB,MAAM,CAACD,UAAU,CAAC;UAEpC,IAAI,CAACV,UAAU,CACb,IAAI,CAAC/B,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAAC,cAAc,EAAE;YACpCC,QAAQ,EAAEtB,KAAK,CAACuB,MAAM,GAAGtB,OAAO,CAACsB;UACnC,CAAC,CACH,CAAC;QACH,CAAC,QAAQ,IAAI,CAAC7C,IAAI,CAACV,YAAY,IAAI,IAAI,CAACgD,YAAY;QAEpD,IAAI,CAACvC,MAAM,CAACoB,cAAc,CAAC;UACzBI,OAAO;UACPD,KAAK;UACLpD,WAAW;UACXsD,WAAW,EAAE;QACf,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOsB,GAAG,EAAE;MACZ;MACA;MACA,IAAI,CAAAA,GAAG,oBAAHA,GAAG,CAAExE,IAAI,MAAK,oBAAoB,EAAE;QACtC,IAAI,CAACyB,MAAM,CAAC2C,IAAI,CAACK,IAAI,CACnB;UAAEC,OAAO,EAAE,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAACG,GAAG,CAACE,OAAO;QAAE,CAAC,EAC/C,SAAS,EACT,IACF,CAAC;QACD;MACF;MAEA,IAAI,CAACC,WAAW,CAACH,GAAG,CAAC;IACvB,CAAC,SAAS;MACR,IAAI,CAAChB,UAAU,CAAC,KAAK,CAAC;IACxB;EACF;;EAEA;AACF;AACA;EACEjB,aAAaA,CAACqC,MAAqB,EAAQ;IACzC,IAAI,CAACtC,SAAS,CAACsC,MAAM,CAACrB,WAAW,EAAEqB,MAAM,CAAC5E,IAAI,CAAC;IAC/C,IAAI,CAAC2D,YAAY,GAAGZ,SAAS;EAC/B;;EAEA;AACF;AACA;EACE,MAAMP,MAAMA,CAAA,EAAkB;IAC5B,IAAI;MACF,MAAAiB,2BAAA,CAAM,IAAI,EAAAtC,UAAA,EAAAA,UAAA,EAAY,MAAOuC,MAAM,IAAK;QACtC,MAAMmB,GAAG,GAAG,MAAM,IAAI,CAACC,QAAQ,CAACtC,MAAM,CAInC;UACDkB;QACF,CAAC,CAAC;QACF;QACA,IAAImB,GAAG,CAACE,EAAE,EAAE;UACV,IAAI,CAACF,GAAG,CAACG,OAAO,EAAE;YAChB,MAAMN,OAAO,GAAG,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAAC,0BAA0B,EAAE;cAChES,QAAQ,EAAE,IAAI,CAACrD,MAAM,CAACwD,KAAK;cAC3BC,GAAG,EAAEL,GAAG,CAACM;YACX,CAAC,CAAC;YACF,IAAI,CAAC1D,MAAM,CAAC2C,IAAI,CAACK,IAAI,CAACC,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC;UAC9C;UAEA,MAAMU,QAAQ,GAAG;YACftC,aAAa,EAAE,KAAK;YACpBE,KAAK,EAAE,EAAE;YACTC,OAAO,EAAE,EAAE;YACXrD,WAAW,EAAE,EAAE;YACfsD,WAAW,EAAE;UACf,CAAC;UACD,IAAI,CAACzB,MAAM,CAACoB,cAAc,CAACuC,QAAQ,CAAC;QACtC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOZ,GAAG,EAAE;MACZ,IAAI,CAACG,WAAW,CAACH,GAAG,CAAC;IACvB;EACF;EAEArC,WAAWA,CAACkD,KAAa,EAAQ;IAC/B,IAAI,CAAC5D,MAAM,CAACoB,cAAc,CAAC;MAAEK,WAAW,EAAEmC;IAAM,CAAC,CAAC;EACpD;EAEAhD,WAAWA,CAAA,EAAS;IAClB,IAAI,CAACZ,MAAM,CAACoB,cAAc,CAAC;MAAEK,WAAW,EAAE;IAAG,CAAC,CAAC;EACjD;EAEA,MAAMT,UAAUA,CAAC6C,YAAsB,EAAiB;IACtD,IAAI;MACF,MAAA7B,2BAAA,CAAM,IAAI,EAAAtC,UAAA,EAAAA,UAAA,EAAY,MAAOuC,MAAM,IAAK;QACtC,IAAI,CAACF,UAAU,CAAC,IAAI,CAAC;QACrB,MAAM,IAAI,CAACsB,QAAQ,CAACS,KAAK,CAAC;UAAED,YAAY;UAAE5B;QAAO,CAAC,CAAC;QACnD,IAAI,CAACjC,MAAM,CAACoB,cAAc,CAAC;UAAEC,aAAa,EAAE;QAAK,CAAC,CAAC;QACnD,IAAI,CAAC0C,cAAc,CAAC,CAAC;MACvB,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOhB,GAAG,EAAE;MACZ,IAAIA,GAAG,CAACxE,IAAI,KAAK,oBAAoB,EAAE;QACrC,IAAI,CAACyB,MAAM,CAAC2C,IAAI,CAACK,IAAI,CACnB;UAAEC,OAAO,EAAE,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAACG,GAAG,CAACE,OAAO;QAAE,CAAC,EAC/C,SAAS,EACT,IACF,CAAC;QACD;MACF;MAEA,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACqB,GAAG,CAAE,iBAAgBjB,GAAG,CAACE,OAAQ,EAAC,CAAC;IACtD,CAAC,SAAS;MACR,IAAI,CAAClB,UAAU,CAAC,KAAK,CAAC;IACxB;EACF;EAEA,MAAMd,YAAYA,CAACgD,KAAY,EAAiB;IAC9C,IAAI,IAAI,CAACC,kBAAkB,CAACD,KAAK,CAAC,IAAI,IAAI,CAAC1B,YAAY,EAAE;MACvD,IAAI,CAAC4B,gBAAgB,GAAG,IAAI;MAE5B,IAAI;QACF,MAAAnC,2BAAA,CAAM,IAAI,EAAAtC,UAAA,EAAAA,UAAA,EAAY,MAAOuC,MAAM,IAAK;UACtC,MAAM;YAAEV,KAAK;YAAEC,OAAO;YAAErD;UAAY,CAAC,GAAG,IAAI,CAAC6B,MAAM,CAACmC,cAAc,CAAC,CAAC;UAEpE,MAAM;YAAEZ,KAAK,EAAEiB,QAAQ;YAAEhB,OAAO,EAAEiB;UAAW,CAAC,GAC5C,MAAAT,2BAAA,CAAM,IAAI,EAAApC,oBAAA,EAAAA,oBAAA,EAAsB;YAC9BzB,WAAW;YACX8D;UACF,CAAC,CAAC;UAEJ,MAAMmC,aAAa,GAAG7C,KAAK,CAACmB,MAAM,CAACF,QAAQ,CAAC;UAC5C,MAAM6B,eAAe,GAAG7C,OAAO,CAACkB,MAAM,CAACD,UAAU,CAAC;UAElD,IAAI,CAACzC,MAAM,CAACoB,cAAc,CAAC;YACzBI,OAAO,EAAE6C,eAAe;YACxB9C,KAAK,EAAE6C;UACT,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOE,KAAK,EAAE;QACd,IAAI,CAACpB,WAAW,CAACoB,KAAK,CAAC;MACzB,CAAC,SAAS;QACR,IAAI,CAACH,gBAAgB,GAAG,KAAK;MAC/B;IACF;EACF;EA6CA,MAAMjD,WAAWA,CAAA,EAAkB;IACjC,IAAI,CAACa,UAAU,CAAC,IAAI,CAAC;IACrB,IAAI;MACF,MAAAC,2BAAA,CAAM,IAAI,EAAAtC,UAAA,EAAAA,UAAA,EAAY,MAAOuC,MAAM,IAAK;QACtC,MAAM;UAAEN;QAAiB,CAAC,GAAG,IAAI,CAAC3B,MAAM,CAACmC,cAAc,CAAC,CAAC;QAEzD,MAAMoC,QAAkB,GAAG,EAAE;QAC7B,MAAM/B,QAAyB,GAAG,EAAE;QAEpC,KAAK,MAAMgC,YAAY,IAAI7C,gBAAgB,EAAE;UAC3C,MAAM;YAAEG;UAAY,CAAC,GAAG0C,YAAY;UAEpC,MAAMC,cAAc,GAAIC,OAAsB,KAAM;YAClD,GAAGA,OAAO;YACV;YACA;YACAC,UAAU,EAAGD,OAAO,CAACE,UAAU,CAC5BC,OAAO,CAACL,YAAY,CAACI,UAAU,EAAY,EAAE,CAAC,CAC9CC,OAAO,CAAC,KAAK,EAAE,EAAE;UACtB,CAAC,CAAC;UAEF,IAAIL,YAAY,CAACM,QAAQ,EAAE;YACzB,IAAIC,OAAO,GAAG,IAAI;YAClB,IAAIC,WAAW,GAAG,CAAC;YAEnB,MAAMC,KAAK,GAAG,IAAIvH,MAAM,CAAC;cAAEwH,WAAW,EAAE;YAAE,CAAC,CAAC;YAE5C,MAAMC,OAAO,GAAI5D,KAAsB,IAAK;cAC1C,KAAK,MAAM6D,OAAO,IAAI7D,KAAK,EAAE;gBAC3B,MAAM8D,OAAO,GAAG,IAAI,CAACC,UAAU,CAACF,OAAO,CAAC;gBAExC,MAAMG,EAAE,GAAG5H,aAAa,CAAC0H,OAAO,EAAE,IAAI,CAACrF,MAAM,CAAC2C,IAAI,CAAC6C,KAAK,CAAC,CAAC,CAAC;gBAC3D;gBACA;gBACA;gBACA;gBACA,IAAI,CAAC,IAAI,CAACxF,MAAM,CAAC2C,IAAI,CAAC8C,wBAAwB,CAACF,EAAE,CAAC,EAAE;kBAClD/C,QAAQ,CAACkD,IAAI,CAACjB,cAAc,CAACW,OAAO,CAAC,CAAC;kBACtCJ,WAAW,EAAE;kBACb,IAAI,CAACjD,UAAU,CACb,IAAI,CAAC/B,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAAC,eAAe,EAAE;oBACrCC,QAAQ,EAAEmC;kBACZ,CAAC,CACH,CAAC;gBACH;gBACAD,OAAO,GAAG,KAAK;cACjB;YACF,CAAC;YAED,MAAA/C,2BAAA,CAAM,IAAI,EAAAnC,wBAAA,EAAAA,wBAAA,EAA0B;cAClCiC,WAAW;cACX8C,UAAU,EAAEnG,WAAW,CACrB+F,YAAY,CAACI,UAAU,EACvBJ,YAAY,CAACjG,IACf,CAAC;cACDoG,UAAU,EAAEH,YAAY,CAACjG,IAAI;cAC7B0G,KAAK;cACLE,OAAO;cACPlD;YACF,CAAC,CAAC;YACF,MAAMgD,KAAK,CAACU,MAAM,CAAC,CAAC;YAEpB,IAAI1C,OAAO;YACX,IAAI8B,OAAO,EAAE;cACX9B,OAAO,GAAG,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAAC,kBAAkB,CAAC;YACrD,CAAC,MAAM,IAAIoC,WAAW,KAAK,CAAC,EAAE;cAC5B/B,OAAO,GAAG,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAAC,oBAAoB,EAAE;gBACpDO,MAAM,EAAEqB,YAAY,CAACjG;cACvB,CAAC,CAAC;YACJ,CAAC,MAAM;cACL;cACA;cACA;cACA0E,OAAO,GAAG,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACC,IAAI,CAAC,aAAa,EAAE;gBAC7CgD,WAAW,EAAEZ,WAAW;gBACxB7B,MAAM,EAAEqB,YAAY,CAACjG;cACvB,CAAC,CAAC;YACJ;YAEAgG,QAAQ,CAACmB,IAAI,CAACzC,OAAO,CAAC;UACxB,CAAC,MAAM;YACLT,QAAQ,CAACkD,IAAI,CAACjB,cAAc,CAACD,YAAY,CAAC,CAAC;UAC7C;QACF;;QAEA;QACA;QACA;QACA;QACA;QACA,IAAI,CAACxE,MAAM,CAAC2C,IAAI,CAACqB,GAAG,CAAC,qCAAqC,CAAC;QAC3D,IAAI,CAAChE,MAAM,CAAC2C,IAAI,CAACkD,QAAQ;QACvB;QACA;QACA;QACArD,QAAQ,CAACnE,GAAG,CAAEyH,IAAI,IAAK,IAAI,CAACR,UAAU,CAACQ,IAAI,EAAE,IAAI,CAACC,eAAe,CAAC,CACpE,CAAC;QAED,IAAI,CAAC/F,MAAM,CAACoB,cAAc,CAAC;UAAEK,WAAW,EAAE;QAAG,CAAC,CAAC;QAC/C8C,QAAQ,CAACyB,OAAO,CAAE/C,OAAO,IAAK,IAAI,CAACjD,MAAM,CAAC2C,IAAI,CAACK,IAAI,CAACC,OAAO,CAAC,CAAC;QAE7D,IAAI,CAACgD,cAAc,CAAC,CAAC;MACvB,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOlD,GAAG,EAAE;MACZ,IAAI,CAACG,WAAW,CAACH,GAAG,CAAC;IACvB,CAAC,SAAS;MACR,IAAI,CAAChB,UAAU,CAAC,KAAK,CAAC;IACxB;EACF;EAEAZ,MAAMA,CACJ+E,KAAc,EACdC,WAA4D,EAC5D;IAAA,IAAAC,KAAA;IAAA,IADAD,WAA4D;MAA5DA,WAA4D,GAAG,CAAC,CAAC;IAAA;IAEjE,MAAM;MAAE9E,aAAa;MAAEgF;IAAe,CAAC,GAAG,IAAI,CAACrG,MAAM,CAACmC,cAAc,CAAC,CAAC;IACtE,MAAM;MAAES;IAAK,CAAC,GAAG,IAAI,CAAC5C,MAAM,CAAC2C,IAAI;IAEjC,IAAI,CAAC0D,cAAc,EAAE;MACnB,IAAI,CAACtC,cAAc,CAAC,CAAC;IACvB;IAEA,MAAMuC,iBAAiB,GAAG;MAAE,GAAG,IAAI,CAACrG,IAAI;MAAE,GAAGkG;IAAY,CAAC;IAC1D,MAAM;MAAE5E,KAAK;MAAEC,OAAO;MAAEC,WAAW;MAAE8E,OAAO;MAAE5E;IAAiB,CAAC,GAC9D,IAAI,CAAC3B,MAAM,CAACmC,cAAc,CAAC,CAAC;IAC9B,MAAM;MAAEqE,SAAS;MAAEC,mBAAmB;MAAEC;IAAY,CAAC,GAAG,IAAI;IAC5D,MAAMC,QAAQ,GAAGlF,WAAW,KAAK,EAAE;IACnC,MAAMmF,UAAU,GAAG,IAAI,CAAC5G,MAAM,CAAC6G,IAAI,IAAIjI,iBAAiB;IAExD,MAAMkI,WAAW,GAAG;MAClBxH,eAAe,EAAEgH,iBAAiB,CAAChH,eAAe;MAClDuB,SAAS,EAAE,IAAI,CAACA,SAAS;MACzB1C,WAAW,EAAE,IAAI,CAAC6B,MAAM,CAACmC,cAAc,CAAC,CAAC,CAAChE,WAAW;MACrDyI,UAAU;MACVpD,KAAK,EAAE,IAAI,CAACxD,MAAM,CAACwD,KAAK;MACxBzC,MAAM,EAAE,IAAI,CAACA,MAAM;MACnBgG,QAAQ,EAAE,IAAI,CAACA,QAAQ;MACvBnE;IACF,CAAC;IAED,MAAMoE,YAAY,GAAG;MACnBR,SAAS;MACTS,cAAc,EAAE,IAAI,CAACA,cAAc,CAACtG,IAAI,CAAC,IAAI,CAAC;MAC9C8F,mBAAmB;MACnB9E,gBAAgB;MAChBJ,KAAK,EAAEoF,QAAQ,GAAGD,WAAW,CAACnF,KAAK,CAAC,GAAGA,KAAK;MAC5CC,OAAO,EAAEmF,QAAQ,GAAGD,WAAW,CAAClF,OAAO,CAAC,GAAGA,OAAO;MAClDV,aAAa,EAAE,IAAI,CAACA,aAAa;MACjCD,SAAS,EAAE,IAAI,CAACA,SAAS;MACzBtB,YAAY,EAAE,IAAI,CAACU,IAAI,CAACV,YAAY;MAEpC;MACA2H,gBAAgB,EAAEZ,iBAAiB,CAACjH,UAAU;MAC9C8H,MAAM,EAAE,IAAI,CAACzG,WAAW;MACxB0G,WAAW,EAAE,IAAI,CAACxG,WAAW;MAC7ByG,UAAU,EAAE5F,WAAW;MACvB6F,aAAa,EAAE,IAAI;MACnBC,gBAAgB,EAAE3E,IAAI,CAAC,QAAQ,CAAC;MAChC4E,gBAAgB,EAAE5E,IAAI,CAAC,aAAa,CAAC;MAErC6E,cAAc,EAAE7E,IAAI,CAAC,cAAc,CAAC;MACpC7B,MAAM,EAAE,IAAI,CAACA,MAAM;MACnBE,YAAY,EAAE,IAAI,CAACA,YAAY;MAC/ByG,IAAI,EAAE,IAAI,CAACxG,WAAW;MACtByG,MAAM,EAAE,IAAI,CAACC,aAAa;MAC1B;MACAC,eAAe,EAAEpK,CAAA,CAACI,MAAM,EAAWiJ,WAAc,CAAC;MAClDtD,KAAK,EAAE,IAAI,CAACxD,MAAM,CAACwD,KAAK;MACxBrE,QAAQ,EAAEmH,iBAAiB,CAACnH,QAAQ;MACpCC,UAAU,EAAEkH,iBAAiB,CAAClH,UAAU;MACxCE,eAAe,EAAEgH,iBAAiB,CAAChH,eAAe;MAClDsH,UAAU;MACVhE,IAAI,EAAE,IAAI,CAAC5C,MAAM,CAAC2C,IAAI,CAACC,IAAI;MAC3BkF,SAAS,EAAE,IAAI,CAAC9H,MAAM,CAAC2C,IAAI,CAACoF,QAAQ,CAAC,CAAC;MACtCC,oBAAoB,EAAE,SAAAA,CAAA;QAAA,OAEjB5B,KAAI,CAACpG,MAAM,CAAC2C,IAAI,CAACqF,oBAAoB,CAAC,GAAAC,SAAO,CAAC;MAAA;MACnDC,SAAS,EAAE3B;IACb,CAAC;IAED,IAAIlF,aAAa,KAAK,KAAK,EAAE;MAC3B,OACE5D,CAAA,CAACM,YAAY;QAACoK,SAAS,EAAE,IAAI,CAAClC;MAAe,GAC3CxI,CAAA,CAACG,QAAQ;QACPwK,UAAU,EAAE,IAAI,CAACpI,MAAM,CAACwD,KAAM;QAC9BoD,UAAU,EAAEA,UAAW;QACvB5F,UAAU,EAAE,IAAI,CAACA,UAAW;QAC5B4B,IAAI,EAAE,IAAI,CAAC5C,MAAM,CAAC2C,IAAI,CAAC0F,SAAU;QACjCC,UAAU,EAAE,IAAI,CAACrI,IAAI,CAACsI,cAAe;QACrChC,OAAO,EAAEA;MAAQ,CAClB,CACW,CAAC;IAEnB;IAEA,OACE9I,CAAA,CAACM,YAAY;MAACoK,SAAS,EAAE,IAAI,CAAClC;IAAe,GAE3CxI,CAAA,CAACK,OAAO,EAAWkJ,YAAe,CACtB,CAAC;EAEnB;AACF;AAAC,eAAAxG,YAzfkBgI,EAA0C,EAAE;EAAA,IAAAC,qBAAA;EAC3D;EACA,CAAAA,qBAAA,GAAAzG,2BAAA,KAAI,EAAAxC,gBAAA,EAAAA,gBAAA,cAAJiJ,qBAAA,CAAuBC,KAAK,CAAC,CAAC;EAC9B,MAAMC,eAAe,GAAG,IAAIC,eAAe,CAAC,CAAC;EAC7C5G,2BAAA,KAAI,EAAAxC,gBAAA,EAAAA,gBAAA,IAAoBmJ,eAAe;EACvC,MAAME,aAAa,GAAGA,CAAA,KAAM;IAC1BF,eAAe,CAACD,KAAK,CAAC,CAAC;IACvB,IAAI,CAACzC,cAAc,CAAC,CAAC;EACvB,CAAC;EACD,IAAI;IACF;IACA;IACA;IACA,IAAI,CAACjG,MAAM,CAAC2C,IAAI,CAACmG,EAAE,CAAC,uBAAuB,EAAED,aAAa,CAAC;IAC3D,IAAI,CAAC7I,MAAM,CAAC2C,IAAI,CAACmG,EAAE,CAAC,YAAY,EAAED,aAAa,CAAC;IAEhD,MAAML,EAAE,CAACG,eAAe,CAAC1G,MAAM,CAAC;EAClC,CAAC,SAAS;IACR;IACA;IACA;IACA,IAAI,CAACjC,MAAM,CAAC2C,IAAI,CAACoG,GAAG,CAAC,uBAAuB,EAAEF,aAAa,CAAC;IAC5D,IAAI,CAAC7I,MAAM,CAAC2C,IAAI,CAACoG,GAAG,CAAC,YAAY,EAAEF,aAAa,CAAC;IACjD7G,2BAAA,KAAI,EAAAxC,gBAAA,EAAAA,gBAAA,IAAoB8B,SAAS;EACnC;AACF;AAAC,eAAAf,OAAAyI,IAAA,EAUE;EAAA,IARS;IACVlH,WAAW;IACX8C,UAAU;IACV3C;EAKF,CAAC,GAAA+G,IAAA;EACC,MAAM;IAAEjC,QAAQ;IAAExE,YAAY;IAAE0G;EAAM,CAAC,GAAG,MAAM,IAAI,CAAC5F,QAAQ,CAAC6F,IAAI,CAI/DpH,WAAW,EAAE;IAAEG;EAAO,CAAC,CAAC;EAC3B,IAAI,CAAC8E,QAAQ,GAAGA,QAAQ,IAAI,IAAI,CAACA,QAAQ;EAEzC,OAAO;IACLkC,KAAK,EAAEA,KAAK,CAAC5K,GAAG,CAAE8K,IAAI,KAAM;MAC1B,GAAGA,IAAI;MACPvE;IACF,CAAC,CAAC,CAAC;IACHrC;EACF,CAAC;AACH;AAAC,eAAAjC,sBAAA8I,KAAA,EAQE;EAAA,IANwB;IACzBjL,WAAW;IACX8D;EAIF,CAAC,GAAAmH,KAAA;EACC,MAAMxE,UAAU,GAAG1G,iBAAiB,CAACC,WAAW,CAAC;EAEjD,MAAM;IAAE8K,KAAK;IAAE1G;EAAa,CAAC,GAAG,MAAAP,2BAAA,CAAM,IAAI,EAAArC,KAAA,EAAAA,KAAA,EAAO;IAC/CmC,WAAW,EAAE,IAAI,CAACS,YAAY;IAC9BqC,UAAU;IACV3C;EACF,CAAC,CAAC;EAEF,IAAI,CAACM,YAAY,GAAGA,YAAY;EAEhC,MAAMhB,KAAsB,GAAG,EAAE;EACjC,MAAMC,OAAwB,GAAG,EAAE;EAEnCyH,KAAK,CAACjD,OAAO,CAAEmD,IAAI,IAAK;IACtB,IAAIA,IAAI,CAACrE,QAAQ,EAAE;MACjBtD,OAAO,CAACkE,IAAI,CAACyD,IAAI,CAAC;IACpB,CAAC,MAAM;MACL5H,KAAK,CAACmE,IAAI,CAACyD,IAAI,CAAC;IAClB;EACF,CAAC,CAAC;EAEF,OAAO;IAAE5H,KAAK;IAAEC;EAAQ,CAAC;AAC3B;AAAC,eAAAnB,0BAAAgJ,KAAA,EAkME;EAAA,IAd4B;IAC7BvH,WAAW;IACX8C,UAAU;IACVD,UAAU;IACVM,KAAK;IACLE,OAAO;IACPlD;EAQF,CAAC,GAAAoH,KAAA;EACC,IAAIC,OAAO,GAAGxH,WAAW;EAEzB,OAAOwH,OAAO,EAAE;IACd,MAAMlG,GAAG,GAAG,MAAApB,2BAAA,CAAM,IAAI,EAAArC,KAAA,EAAAA,KAAA,EAAO;MAAEmC,WAAW,EAAEwH,OAAO;MAAE1E,UAAU;MAAE3C;IAAO,CAAC,CAAC;IAC1EqH,OAAO,GAAGlG,GAAG,CAACb,YAAY;IAE1B,MAAMhB,KAAK,GAAG6B,GAAG,CAAC6F,KAAK,CAACM,MAAM,CAAEJ,IAAI,IAAK,CAACA,IAAI,CAACrE,QAAQ,CAAC;IACxD,MAAMtD,OAAO,GAAG4B,GAAG,CAAC6F,KAAK,CAACM,MAAM,CAAEJ,IAAI,IAAKA,IAAI,CAACrE,QAAQ,CAAC;IAEzDK,OAAO,CAAC5D,KAAK,CAAC;;IAEd;IACA,MAAMiI,QAAQ,GAAGhI,OAAO,CAACnD,GAAG,CAAC,MAAO8E,MAAM,IACxC8B,KAAK,CAACwE,GAAG,CAAC,YAAAzH,2BAAA,CACR,IAAI,EAAAnC,wBAAA,EAAAA,wBAAA,EAA0B;MAC5BiC,WAAW,EAAEqB,MAAM,CAACrB,WAAW;MAC/B8C,UAAU,EAAEnG,WAAW,CAACmG,UAAU,EAAEzB,MAAM,CAAC5E,IAAI,CAAC;MAChDoG,UAAU,EAAElG,WAAW,CAACkG,UAAU,EAAExB,MAAM,CAAC5E,IAAI,CAAC;MAChD0G,KAAK;MACLE,OAAO;MACPlD;IACF,CAAC,CACH,CACF,CAAC;IACD,MAAMyH,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC,EAAC;EAC9B;AACF;AAlWmB1J,YAAY,CAMxB8J,OAAO,GAAG3L,WAAW,CAAC4L,OAAO"}